# R script to download selected samples
# Copy code and run on a local machine to initiate download

## set working directory
setwd('/home/locutus-of-borg/Documents/brent_lab/archs4_mouse')

# Check for dependencies and install if missing
packages <- c("rhdf5", "dplyr")
## include custom dependences functions here
#BiocManager::install("GEOquery")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
  print("Install required packages")
  source("https://bioconductor.org/biocLite.R")
  biocLite("rhdf5")
}
library("rhdf5")
library("tools")
library("dplyr")
library("GEOquery")

destination_file = "mouse_matrix_download.h5"
extracted_expression_file = "mouse_possible_txfactor_datasets.csv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/mouse_matrix.h5"

# Check if gene expression file was already downloaded and check integrity, if not in current directory download file form repository
if(!file.exists(destination_file)){
  print("Downloading compressed gene expression matrix.")
  download.file(url, destination_file, quiet = FALSE)
} else{
  print("Verifying file integrity...")
  checksum = md5sum(destination_file)
  
  if(destination_file == "human_matrix_download.h5"){
    # human checksum (checksum is for latest version of ARCHS4 data)
    correct_checksum = "34197866d7841cc4fb31e09195faa150"
  } else{
    # mouse checksum (checksum is for latest version of ARCHS4 data)
    correct_checksum = "55441d1af9da82c6f3d368c8fa554d42"
  }
  
  if(checksum != correct_checksum){
    print("Existing file looks corrupted or is out of date. Downloading compressed gene expression matrix again.")
    download.file(url, destination_file, quiet = FALSE)
  } else{
    print("Latest ARCHS4 file already exists.")
  }
}

checksum = md5sum(destination_file)
if(destination_file == "human_matrix_download.h5"){
  # human checksum (checksum is for latest version of ARCHS4 data)
  correct_checksum = "34197866d7841cc4fb31e09195faa150"
} else{
  # mouse checksum (checksum is for latest version of ARCHS4 data)
  correct_checksum = "55441d1af9da82c6f3d368c8fa554d42"
}

if(checksum != correct_checksum){
  print("File download ran into problems. Please try to download again. The files are also available for manual download at http://amp.pharm.mssm.edu/archs4/download.html.")
} else{
  # Selected samples to be extracted

  crispr <- c("GSM2219673","GSM2219671","GSM2411984","GSM2411985","GSM2411982","GSM2411983","GSM2411980","GSM2411981","GSM2411969","GSM2411979",
              "GSM2411978","GSM2411973","GSM2411972","GSM2411971","GSM2411970","GSM2411977","GSM2411976","GSM2411975","GSM2411974","GSM2411968",
              "GSM2907029","GSM2907030","GSM2907031","GSM2907032","")
  cas9 <- c("GSM2219670","GSM2219669","GSM2219668","GSM2257135","GSM2257136","GSM2257137","GSM2257138","GSM2257139","GSM2257140","GSM2396856",
            "GSM2396857","GSM2402778","GSM2402779","GSM2402780","GSM2402781","GSM2402782","GSM2402783","GSM2402784","GSM2402785","GSM2627245",
            "GSM2627246","GSM2627247","GSM2627248","GSM2627249","GSM2627250","GSM2627251","GSM2627252","GSM2627253","GSM2627254","GSM2627255","GSM2627256",
            "")
  knockdown <- c("GSM1518085","GSM1520030","GSM1489192","GSM1518084","GSM1520031","GSM1518092","GSM1518076","GSM976932","GSM1520033","GSM1518086","GSM1520032","GSM1520029","GSM1518091","GSM1518093","GSM1518079","GSM1518074","GSM976933","GSM1489186","GSM1518077","GSM1518089","GSM976931","GSM1518090","GSM1520034","GSM1489193","GSM1518072","GSM1489183","GSM1586367","GSM1489189","GSM1861146","GSM1489185","GSM1974188",
                 "GSM1518087","GSM1974190","GSM1974189","GSM1489187","GSM1489191","GSM1518102","GSM1518099","GSM1586365","GSM1489188","GSM1489184","GSM1861145","GSM1518088","GSM1974192","GSM1861143","GSM1861151","GSM1586363","GSM1518101","GSM1974187","GSM1861144","GSM1861150","GSM1518080","GSM1489190","GSM1586364","GSM1861149","GSM1974191","GSM1861148","GSM1586366","GSM1861142","GSM1518103","GSM1518104",
                 "GSM1974185","GSM1861147","GSM1518100","GSM1974186","GSM1865853","GSM2758967","GSM2758968","GSM2758969","GSM1706494","GSM1706496","GSM1875032","GSM1875033","GSM1875034","GSM2039054","GSM2039055","GSM2039057","GSM2039058","GSM2039059","GSM2039060","GSM2039061","GSM2039062","GSM2039066","GSM2039068","GSM3024019","GSM3024020","GSM3024021","GSM3024022","GSM2830040","GSM2830041","GSM2830042",
                 "GSM2636344","GSM2636345","GSM2636346","GSM2636347","")
  
  knockout <- c("GSM1842777","GSM1138588","GSM1346214","GSM1677460","GSM1290887","GSM1138585","GSM1210218","GSM1409308","GSM1008469","GSM1334361","GSM1210224","GSM1958897","GSM1677458","GSM1373654","GSM1409298","GSM1409306","GSM1677457","GSM1409310","GSM1210219","GSM1409301","GSM1409300","GSM1409305","GSM1409311","GSM1409299","GSM1334362","GSM1138589","GSM1677459","GSM1373655","GSM1138586","GSM1290888","GSM1409312",
                "GSM1842776","GSM1210221","GSM1409313","GSM1583054","GSM1138584","GSM1842775","GSM1138587","GSM1842774","GSM1409307","GSM1608133","GSM1210220","GSM1008470","GSM1334360","GSM1008468","GSM1409309","GSM1677461","GSM1583055","GSM1210222","GSM1974137","GSM1824694","GSM1819903","GSM1824693","GSM1974166","GSM1974148","GSM1974199","GSM1819911","GSM1819910","GSM1974172","GSM1974198","GSM1974176",
                "GSM1974165","GSM1561103","GSM1974143","GSM1974174","GSM1936021","GSM1974169","GSM1974139","GSM1974195","GSM1423553","GSM1819912","GSM1974136","GSM1974133","GSM1974175","GSM1707910","GSM1707911","GSM1974146","GSM1864004","GSM1974168","GSM1974200","GSM1974134","GSM1819907","GSM1423556","GSM1974196","GSM1819908","GSM1974135","GSM1561106","GSM1974193","GSM1974194","GSM1931660","GSM1974170",
                "GSM1974144","GSM1974141","GSM1561105","GSM1864006","GSM1819902","GSM1974147","GSM1974197","GSM1974140","GSM1706506","GSM1974167","GSM1819904","GSM1936022","GSM1423555","GSM1974145","GSM1974173","GSM1974142","GSM1864005","GSM1936023","GSM1819906","GSM1561104","GSM1974171","GSM1974138","GSM1423554","GSM1821419","GSM1821421","GSM1821420","GSM2042348","GSM2042349","GSM2042344","GSM2042345",
                "GSM2042346","GSM2042347","GSM2042343","GSM2042351","GSM2042350","GSM1621025","GSM2178237","GSM2178236","GSM2178238","GSM2432273","GSM2432274","GSM2432275","GSM2432276","GSM2538383","GSM2538384","GSM2538385","GSM2538386","GSM2692145","GSM2692146","GSM2692147","GSM2692148","GSM2085872","GSM2085873","GSM2257685","GSM2257686","GSM2257687","GSM2258530","GSM2258531","GSM2258532","GSM2344483",
                "GSM2344484","GSM2344485","GSM2344486","GSM2344487","GSM2344488","GSM2344489","GSM2344490","GSM2478306","GSM2478307","GSM2478308","GSM2478309","GSM2478310","GSM2478311","GSM2628314","GSM2628315","GSM2628316","GSM2628317","GSM2628318","GSM2628319","GSM2628320","GSM2628321","GSM2628322","GSM2628323","GSM2628324","GSM2628325","GSM2628326","GSM2628327","GSM2628328","GSM2628329","GSM2628330",
                "GSM2628331","GSM2628332","GSM2628333","GSM2628334","GSM2628336","GSM2628338","GSM2628341","GSM2628343","GSM2628346","GSM2628349","GSM2628351","GSM2628365","GSM2628367","GSM2628370","GSM2628373","GSM2628375","GSM2628378","GSM2628380","GSM2628383","GSM2628386","GSM2628388","GSM2628391","GSM2628394","GSM2628396","GSM2628398","GSM2628400","GSM2628402","GSM2628406","GSM2628407","GSM2628408",
                "GSM2628409","GSM2628410","GSM2628411","GSM2628412","GSM2628413","GSM2628414","GSM2628415","GSM2628552","GSM2628553","GSM2628556","GSM2628557","GSM2628560","GSM2628561","GSM2561560","GSM2561561","GSM2907019","GSM2907020","GSM2907021","GSM2705199","GSM2705200","GSM2889476","GSM2889477","GSM2889478","GSM2889479","GSM1530536","GSM1530537","GSM1706491","GSM1706492","GSM1824695","GSM1824696",
                "GSM2065422","GSM2065423","GSM2065424","GSM2065425","GSM2065426","GSM2065427","GSM2065428","GSM2065429","GSM2065430","GSM2065431","GSM2065432","GSM2065433","GSM2065434","GSM2065435","GSM2065436","GSM2065437","GSM2065438","GSM2065439","GSM2065440","GSM2065441","GSM2065442","GSM2065443","GSM2065444","GSM2065445","GSM2065446","GSM2065447","GSM2065448","GSM2065449","GSM2065450","GSM2065451",
                "GSM2065452","GSM2065453","GSM2065454","GSM2065455","GSM2065456","GSM2065457","GSM2065458","GSM2065459","GSM2065460","GSM2065461","GSM2065462","GSM2065463","GSM2065464","GSM2065465","GSM2065466","GSM2065467","GSM2065468","GSM2065469","GSM2065470","GSM2065471","GSM2065472","GSM2065473","GSM2065474","GSM2065475","GSM2065476","GSM2065477","GSM2065478","GSM2065479","GSM2065480","GSM2065481",
                "GSM2065482","GSM2065483","GSM2065484","GSM2065485","GSM2065486","GSM2065487","GSM2065488","GSM2065489","GSM2065491","GSM2200014","GSM2200015","GSM2200016","GSM2241941","GSM2241942","GSM2241943","GSM2757547","GSM2757548","GSM2757549","GSM2757556","GSM2757557","GSM2883340","GSM2883341","GSM2883342","GSM2883343","GSM2883344","GSM2883345","GSM2948617","GSM2948618","GSM2948619","GSM2948620",
                "GSM2948621","GSM2948622","GSM2948623","GSM2948624","GSM2948625","GSM2948626","GSM2948627","GSM2948628","GSM2120832","GSM2120833","GSM2120834","GSM2120837","GSM2120838","GSM2702337","GSM2702338","GSM2702339","GSM2907121","GSM2907122","GSM2907123","GSM3111065","GSM3111066","GSM3111067","GSM3111070","GSM3111071","GSM3111075","GSM3111076","GSM3111077","GSM2561556","GSM2561557","GSM2561564",
                "GSM2561565","GSM2561568","GSM2561569","GSM2561572","GSM2561574","GSM2935273","")
  
  induction <- c("GSM1419129","GSM1419122","GSM1419111","GSM1419126","GSM1419118","GSM1419115","GSM1419117","GSM1419137","GSM1419123","GSM1419132",
                 "GSM1419136","GSM1419131","GSM1419121","GSM1419116","GSM1419119","GSM1419114","GSM1419127","GSM1419113","GSM1419135","GSM1419128",
                 "GSM1419134","GSM1419124","GSM1419125","GSM1419112","GSM1419130","GSM1419120","GSM1419133","")
  
  overexpression <- c("GSM1515737","GSM1515735","GSM1515736","GSM2038624","GSM1590735","GSM2038629","GSM2060453","GSM2038626","GSM2038628","GSM2038627","GSM2060454","GSM1590734","GSM1590732","GSM2038625","GSM1808879","GSM1624828","GSM2179850","GSM2179848","GSM2179852","GSM1624829","GSM2179854","GSM1808880","GSM1495736","GSM1495734","GSM1495735","GSM2715138","GSM2715139","GSM2715140","GSM2715141","GSM2793840","GSM2793841",
                      "GSM2793842","GSM1706489","")
  
  over_expression <- c("GSM1515737","GSM1515735","GSM1515736","GSM2038624","GSM1590735","GSM2038629","GSM2060453","GSM2038626","GSM2038628","GSM2038627","GSM2060454","GSM1590734","GSM1590732","GSM2038625","GSM1808879","GSM1624828","GSM2179850","GSM2179848","GSM2179852","GSM1624829","GSM2179854","GSM1808880","GSM1495736","GSM1495734","GSM1495735","GSM2715138","GSM2715139","GSM2715140","GSM2715141","GSM2793840","GSM2793841",
                       "GSM2793842","GSM1706489","")
  
  ko <- c("GSM1297316","GSM1381945","GSM1229014","GSM1366902","GSM2300059","GSM1833468","GSM1842777","GSM1833466","GSM1138588","GSM1346214","GSM1569076","GSM1282484","GSM1869167","GSM1604240","GSM1290527","GSM1495154","GSM1857082","GSM1787259","GSM1677460","GSM2097481","GSM1383891","GSM1173820","GSM1816900","GSM1833470","GSM2323345","GSM2074788","GSM1290887","GSM1138585","GSM1787266","GSM1098604","GSM2074791",
          "GSM1210218","GSM1581285","GSM1528815","GSM1569078","GSM1372616","GSM1297317","GSM1504925","GSM1819951","GSM1397547","GSM1723365","GSM1643271","GSM1173813","GSM2085044","GSM1416789","GSM1819969","GSM1495172","GSM1297319","GSM1587565","GSM2157158","GSM1409308","GSM1988207","GSM1008469","GSM1173811","GSM1383884","GSM1282481","GSM2363451","GSM1820460","GSM1954930","GSM1464573","GSM1921173",
          "GSM1310487","GSM1495175","GSM1816902","GSM1847713","GSM1297324","GSM1869166","GSM1067619","GSM1643266","GSM1232583","GSM1244667","GSM1819953","GSM1495168","GSM1820462","GSM1847712","GSM1346277","GSM1334361","GSM1495170","GSM2154832","GSM2192710","GSM1569082","GSM2323351","GSM1495157","GSM1053288","GSM1397549","GSM1383883","GSM1210224","GSM2142347","GSM1420575","GSM1416782","GSM1958897",
          "GSM1464571","GSM1569079","GSM1257577","GSM1397553","GSM1585053","GSM1403300","GSM1787267","GSM1297321","GSM2363446","GSM1144558","GSM1282478","GSM1346276","GSM1227457","GSM2254624","GSM1504377","GSM1593162","GSM1528812","GSM1346280","GSM1677458","GSM1373654","GSM1604247","GSM1585051","GSM1624982","GSM1593163","GSM1833469","GSM1173821","GSM1643263","GSM1643265","GSM1053280","GSM1346032",
          "GSM1787246","GSM1888161","GSM1723436","GSM1409298","GSM1857084","GSM1409306","GSM1416791","GSM1173819","GSM1611686","GSM2154828","GSM1098602","GSM1677457","GSM2074786","GSM1053281","GSM1921180","GSM1409310","GSM1257566","GSM1833471","GSM1403298","GSM1210219","GSM1495156","GSM1101901","GSM2074793","GSM1495162","GSM1346034","GSM1979340","GSM1098599","GSM1383892","GSM1504924","GSM1208168",
          "GSM2085045","GSM1954928","GSM1921186","GSM1291220","GSM2254622","GSM1633723","GSM1229019","GSM1229020","GSM1816901","GSM1173825","GSM1314841","GSM1504374","GSM2254618","GSM1257554","GSM1937093","GSM1297325","GSM1403299","GSM1646355","GSM1611685","GSM1385055","GSM1581283","GSM2192711","GSM2323344","GSM1833467","GSM1346279","GSM2074785","GSM1569080","GSM1585050","GSM1409301","GSM1282485",
          "GSM1290536","GSM2142345","GSM1282482","GSM1227459","GSM1173817","GSM2254629","GSM1857087","GSM1383882","GSM1819959","GSM1921170","GSM1787237","GSM1290534","GSM1604253","GSM1098606","GSM2363443","GSM1787236","GSM1173827","GSM1643264","GSM1257570","GSM1888160","GSM1297323","GSM1409300","GSM1593165","GSM1397551","GSM1723366","GSM2085043","GSM1053289","GSM1208171","GSM1385051","GSM1291223",
          "GSM2203965","GSM1495159","GSM1409305","GSM1643267","GSM1297320","GSM1819961","GSM2363444","GSM997575","GSM2199437","GSM1495153","GSM1101908","GSM1495146","GSM1257567","GSM1366905","GSM1409311","GSM1604243","GSM1921188","GSM1820461","GSM1819982","GSM1624984","GSM1409299","GSM997573","GSM1787252","GSM1282486","GSM1227458","GSM1334362","GSM1787251","GSM1604248","GSM2157159","GSM1979339",
          "GSM1053278","GSM1979334","GSM1787264","GSM1857085","GSM1624983","GSM1495173","GSM1723435","GSM1643262","GSM1138589","GSM2042147","GSM1723438","GSM1855894","GSM1787227","GSM1382356","GSM1282487","GSM1888166","GSM2074792","GSM1819987","GSM2199438","GSM1383893","GSM1677459","GSM997576","GSM1053283","GSM2074789","GSM1386605","GSM1604249","GSM1373655","GSM1787277","GSM1888164","GSM1138586",
          "GSM1921187","GSM1979342","GSM1232581","GSM1787257","GSM2323350","GSM1857083","GSM2157155","GSM1504921","GSM1888163","GSM1495166","GSM1098601","GSM1787242","GSM1366904","GSM1495158","GSM2363452","GSM1857081","GSM1173815","GSM1195694","GSM1787243","GSM1173812","GSM1787245","GSM1921171","GSM1346028","GSM1397542","GSM1290526","GSM1847714","GSM1643270","GSM1291222","GSM1053279","GSM1282483",
          "GSM2157517","GSM1604250","GSM1723363","GSM2074790","GSM997574","GSM1366901","GSM1290888","GSM1409312","GSM1381948","GSM1290530","GSM1604245","GSM1232584","GSM2142346","GSM1381943","GSM1381949","GSM1954929","GSM1787272","GSM2254619","GSM1842776","GSM1921172","GSM1819960","GSM1979336","GSM1495152","GSM1495160","GSM1210221","GSM1723437","GSM1624986","GSM1257556","GSM1290538","GSM2074787",
          "GSM1416786","GSM1921179","GSM1409313","GSM2300057","GSM1297315","GSM1194346","GSM1819981","GSM2254627","GSM1624981","GSM1820459","GSM2254617","GSM1583054","GSM1857086","GSM2097482","GSM1098605","GSM2199436","GSM1420577","GSM1186242","GSM1385049","GSM2112617","GSM1229016","GSM2254630","GSM1504375","GSM1291224","GSM1291225","GSM1420573","GSM1819988","GSM1138584","GSM1208169","GSM1290531",
          "GSM1257564","GSM1173824","GSM1144559","GSM1979338","GSM1921178","GSM1787271","GSM1346278","GSM1528816","GSM1504373","GSM1381942","GSM1633725","GSM1416790","GSM1215099","GSM1842775","GSM2199435","GSM1495148","GSM2323349","GSM1416784","GSM1857088","GSM1208167","GSM1787255","GSM1101907","GSM1257578","GSM1416787","GSM1098600","GSM1138587","GSM1921181","GSM1290528","GSM1257561","GSM1585052",
          "GSM1979337","GSM1229017","GSM1173826","GSM1604238","GSM1098603","GSM2074784","GSM1257559","GSM2323346","GSM1919138","GSM1282480","GSM1416788","GSM1244664","GSM1257576","GSM1495149","GSM1215098","GSM1842774","GSM1290533","GSM1257569","GSM2157156","GSM1257562","GSM1366903","GSM1819996","GSM1282477","GSM2323343","GSM1855895","GSM2097483","GSM1257565","GSM1495155","GSM1979335","GSM1173828",
          "GSM1979341","GSM1229973","GSM1257581","GSM1291221","GSM2254628","GSM1495171","GSM1219564","GSM1604237","GSM2154831","GSM1173814","GSM1229015","GSM1409307","GSM1624985","GSM1290532","GSM1495164","GSM1257574","GSM1290537","GSM1787278","GSM1053287","GSM2323347","GSM1410614","GSM1608133","GSM1495169","GSM1819968","GSM1611690","GSM1208170","GSM1173822","GSM1643272","GSM2363445","GSM1385050",
          "GSM1257563","GSM1604239","GSM2085049","GSM1346036","GSM1210220","GSM1819952","GSM2157526","GSM1819967","GSM1593167","GSM1257575","GSM1101902","GSM1290529","GSM1569081","GSM1643261","GSM1101906","GSM1787241","GSM2112616","GSM1888162","GSM1282488","GSM1346281","GSM2203967","GSM1257555","GSM1357751","GSM1495165","GSM1495174","GSM1464572","GSM1495151","GSM2254620","GSM2199439","GSM2112618",
          "GSM1257579","GSM1611689","GSM2085051","GSM2157527","GSM1604244","GSM2254625","GSM1257558","GSM1604235","GSM1495147","GSM1219565","GSM1888165","GSM1346030","GSM1847715","GSM1290535","GSM1819985","GSM1381944","GSM2192712","GSM1787248","GSM1385054","GSM1314843","GSM2112615","GSM1173818","GSM1282479","GSM1495167","GSM1816897","GSM2363450","GSM1495150","GSM1008470","GSM2154829","GSM2300058",
          "GSM1633721","GSM2112619","GSM2323348","GSM1787226","GSM1334360","GSM2254626","GSM1257557","GSM1819986","GSM1416783","GSM1495161","GSM1919139","GSM1416785","GSM1173823","GSM1504376","GSM1643269","GSM1053282","GSM1008468","GSM1581284","GSM2154833","GSM1569077","GSM1409309","GSM1787232","GSM2085050","GSM2154830","GSM2254614","GSM1495176","GSM1229013","GSM1495163","GSM1257560","GSM2254623",
          "GSM1677461","GSM1229018","GSM1643268","GSM1646352","GSM1173816","GSM1385053","GSM1583055","GSM1385056","GSM2254621","GSM1723364","GSM1385052","GSM1819995","GSM1208172","GSM2254613","GSM2203966","GSM1581282","GSM1787275","GSM1210222","GSM1257568","GSM1257580","GSM1382358","GSM1604254","GSM2157518","GSM1511613","GSM1511655","GSM2121188","GSM1664496","GSM1864002","GSM1511660","GSM1511666",
          "GSM2072871","GSM1903914","GSM1511692","GSM1511702","GSM1511671","GSM1974137","GSM1511680","GSM1511640","GSM2237809","GSM1511604","GSM1874210","GSM1511687","GSM1511629","GSM2157522","GSM1511684","GSM1824694","GSM1511698","GSM2209563","GSM1511656","GSM1922059","GSM2050910","GSM1673363","GSM1511605","GSM2182504","GSM2083753","GSM1511638","GSM1511700","GSM1827613","GSM2055612","GSM1819903",
          "GSM2331524","GSM1511691","GSM1824693","GSM1496229","GSM1788710","GSM1903918","GSM1974166","GSM1974148","GSM2196439","GSM1511603","GSM1922061","GSM1511609","GSM2182502","GSM1511636","GSM1496239","GSM1974199","GSM2121186","GSM1892306","GSM1819911","GSM2072845","GSM1397351","GSM1511672","GSM1511644","GSM1511621","GSM1819910","GSM1511651","GSM2331526","GSM1864001","GSM1511597","GSM2121189",
          "GSM1511670","GSM1974172","GSM1511674","GSM1511619","GSM1511701","GSM1511697","GSM1788721","GSM1939592","GSM1511631","GSM1511690","GSM2157519","GSM1974198","GSM1974176","GSM1511663","GSM1511695","GSM1717177","GSM1788719","GSM1511685","GSM1664497","GSM1788736","GSM1387947","GSM2059235","GSM1974165","GSM1788744","GSM1788726","GSM2059234","GSM1892308","GSM1511600","GSM1717328","GSM1561103",
          "GSM1974143","GSM1511654","GSM2072861","GSM1511699","GSM1974174","GSM2182638","GSM1511611","GSM1936021","GSM1477311","GSM1511614","GSM1511599","GSM1511643","GSM1511608","GSM1511678","GSM1939597","GSM2072857","GSM1511617","GSM1511645","GSM1974169","GSM1511688","GSM1511658","GSM1974139","GSM1788733","GSM1713505","GSM1974195","GSM1423553","GSM2224574","GSM1496240","GSM1511635","GSM2157521",
          "GSM1387945","GSM1788747","GSM1788725","GSM2323456","GSM1939601","GSM2301541","GSM1496230","GSM1664493","GSM1496238","GSM1819912","GSM1961596","GSM1634469","GSM1511610","GSM1511675","GSM1511624","GSM1974136","GSM1974133","GSM1974175","GSM1788730","GSM2055614","GSM1511694","GSM2224573","GSM1511677","GSM1922071","GSM2050909","GSM1511650","GSM1387949","GSM1496237","GSM1707910","GSM1707911",
          "GSM1788729","GSM2083752","GSM2323455","GSM2157520","GSM2182636","GSM1874212","GSM1961598","GSM1717325","GSM1922062","GSM1974146","GSM1496227","GSM1511673","GSM1864004","GSM1511647","GSM1511623","GSM2196440","GSM1511615","GSM1713504","GSM1496231","GSM1646360","GSM1646359","GSM1511648","GSM1974168","GSM1511703","GSM1974200","GSM2224575","GSM1974134","GSM1939596","GSM1646358","GSM1819907",
          "GSM1664499","GSM1423556","GSM1511659","GSM1974196","GSM1511632","GSM1819908","GSM1496234","GSM1511693","GSM1974135","GSM1717180","GSM1717326","GSM1511696","GSM1496226","GSM1673364","GSM1511641","GSM1511681","GSM1557535","GSM1496225","GSM1561106","GSM1717175","GSM1511652","GSM1974193","GSM1397352","GSM1634468","GSM1974194","GSM1788745","GSM1511616","GSM2331532","GSM1511664","GSM2072847",
          "GSM1788717","GSM1931660","GSM1788716","GSM2331529","GSM1496233","GSM1974170","GSM1664498","GSM2072859","GSM1974144","GSM2209564","GSM1874211","GSM1974141","GSM1827614","GSM1873362","GSM2301540","GSM2182503","GSM1874209","GSM1664494","GSM1496235","GSM1788740","GSM1673365","GSM1864003","GSM1664495","GSM1561105","GSM1922060","GSM2331530","GSM1864006","GSM1892305","GSM2209562","GSM1819902",
          "GSM1939593","GSM2072849","GSM1974147","GSM1713503","GSM1788709","GSM1664500","GSM1974197","GSM1511669","GSM1477312","GSM1922070","GSM1974140","GSM1557533","GSM1634470","GSM1511626","GSM2331523","GSM1788738","GSM1706506","GSM2331527","GSM1974167","GSM1819904","GSM1646357","GSM1939600","GSM1511630","GSM1936022","GSM2331528","GSM1477313","GSM1903917","GSM1922072","GSM1634467","GSM1423555",
          "GSM1557534","GSM1974145","GSM1974173","GSM1922074","GSM2072873","GSM1974142","GSM2331525","GSM2072869","GSM1864005","GSM2121187","GSM1903915","GSM1936023","GSM2059233","GSM1922073","GSM2331531","GSM1819906","GSM2182637","GSM1892307","GSM1496232","GSM1419171","GSM1561104","GSM1496228","GSM1974171","GSM1496236","GSM1557536","GSM1974138","GSM1397350","GSM1827615","GSM1922069","GSM1423554",
          "GSM1788737","GSM2144684","GSM2341165","GSM2144688","GSM2144689","GSM2144685","GSM1821419","GSM2144697","GSM2144696","GSM2144693","GSM2144692","GSM2341164","GSM2341166","GSM2102983","GSM2102985","GSM1821421","GSM1821420","GSM2219673","GSM2219671","GSM1626699","GSM1626698","GSM1626693","GSM1626695","GSM1626694","GSM1626697","GSM1626696","GSM2057856","GSM2057857","GSM2057855","GSM2057858",
          "GSM2057859","GSM2254446","GSM2254447","GSM2254448","GSM2057878","GSM2057879","GSM2057870","GSM2057871","GSM2057872","GSM2057873","GSM2057874","GSM2057875","GSM2057876","GSM2057877","GSM2411984","GSM2411985","GSM2411982","GSM2411983","GSM2411980","GSM2411981","GSM1626677","GSM1626679","GSM1626678","GSM2411969","GSM2042348","GSM2042349","GSM2042344","GSM2042345","GSM2042346","GSM2042347",
          "GSM2042343","GSM2095893","GSM2095894","GSM1626682","GSM1626683","GSM1626680","GSM1626681","GSM1626684","GSM2057864","GSM2057863","GSM2057862","GSM2057861","GSM1626651","GSM1626650","GSM1626652","GSM2057860","GSM1495731","GSM1626648","GSM1626649","GSM1626646","GSM1626647","GSM1626645","GSM1626661","GSM1626662","GSM1626663","GSM1626664","GSM1626665","GSM1626666","GSM1626667","GSM1626668",
          "GSM2411979","GSM2411978","GSM2411970","GSM2411977","GSM2411976","GSM2411975","GSM2411974","GSM2411968","GSM1626700","GSM2042351","GSM2042350","GSM1621025","GSM2463125","GSM2463122","GSM2463124","GSM2463126","GSM2463121","GSM2463123","GSM2386104","GSM2386105","GSM2386103","GSM2386102","GSM2101811","GSM2101810","GSM2101812","GSM2101816","GSM2101818","GSM2101817","GSM2127371","GSM2127370",
          "GSM2142314","GSM2142311","GSM2142312","GSM2142313","GSM2142316","GSM2142315","GSM2178237","GSM2178236","GSM2178238","GSM2199345","GSM2199343","GSM2199344","GSM2251626","GSM2251627","GSM2251628","GSM2252024","GSM2252025","GSM2310401","GSM2310402","GSM2310396","GSM2310403","GSM2310395","GSM2310397","GSM2339521","GSM2389809","GSM2389810","GSM2389811","GSM2395773","GSM2395774","GSM2395786",
          "GSM2395785","GSM2395769","GSM2395781","GSM2395775","GSM2395787","GSM2395768","GSM2395780","GSM2395779","GSM2402572","GSM2402542","GSM2402559","GSM2402544","GSM2402546","GSM2402570","GSM2402561","GSM2402547","GSM2402537","GSM2402545","GSM2402543","GSM2402538","GSM2402563","GSM2402571","GSM2402560","GSM2402536","GSM2402562","GSM2424693","GSM2424684","GSM2424683","GSM2424689","GSM2424687",
          "GSM2424690","GSM2424692","GSM2424686","GSM2436883","GSM2436885","GSM2436882","GSM2461726","GSM2461742","GSM2461733","GSM2461725","GSM2461729","GSM2461738","GSM2461741","GSM2461730","GSM2461737","GSM2466795","GSM2466796","GSM2466803","GSM2466802","GSM2466801","GSM2466797","GSM2473162","GSM2473166","GSM2473164","GSM2473163","GSM2473161","GSM2473152","GSM2473155","GSM2473169","GSM2473153",
          "GSM2473157","GSM2473160","GSM2473154","GSM2483405","GSM2483399","GSM2483403","GSM2483397","GSM2483402","GSM2483404","GSM2483398","GSM2483396","GSM2483401","GSM2483400","GSM2492561","GSM2492562","GSM2492565","GSM2492564","GSM2492563","GSM2496343","GSM2496341","GSM2496342","GSM2496340","GSM2538133","GSM2538136","GSM2538135","GSM2538137","GSM2538134","GSM2538138","GSM2538140","GSM2538139",
          "GSM2585320","GSM2585319","GSM2585322","GSM2585321","GSM2587669","GSM2587670","GSM2587666","GSM2587668","GSM2587665","GSM2587667","GSM2598122","GSM2598120","GSM2598121","GSM2598119","GSM1919521","GSM1919523","GSM2203820","GSM2228378","GSM2228379","GSM2228380","GSM2228381","GSM2300437","GSM2300438","GSM2300439","GSM2300440","GSM2300441","GSM2393992","GSM2393999","GSM2394000","GSM2394001",
          "GSM2431696","GSM2431697","GSM2431698","GSM2431700","GSM2431701","GSM2431702","GSM2431704","GSM2431705","GSM2431706","GSM2431708","GSM2431709","GSM2431710","GSM2432273","GSM2432274","GSM2432275","GSM2432276","GSM2538383","GSM2538384","GSM2538385","GSM2538386","GSM2590028","GSM2590029","GSM2676989","GSM2676990","GSM2678051","GSM2678052","GSM2692145","GSM2692146","GSM2692147","GSM2692148",
          "GSM2730272","GSM2730273","GSM2730274","GSM2730275","GSM2736942","GSM2736943","GSM2736944","GSM2736945","GSM2736946","GSM2736947","GSM2736948","GSM2736949","GSM2742739","GSM2742740","GSM2742741","GSM2742742","GSM2742743","GSM2742744","GSM2817092","GSM2817093","GSM2817094","GSM2817095","GSM2817096","GSM2817097","GSM2045692","GSM2045693","GSM2045694","GSM2085872","GSM2085873","GSM2199847",
          "GSM2199848","GSM2199849","GSM2199850","GSM2227754","GSM2227755","GSM2227756","GSM2227757","GSM2227758","GSM2227764","GSM2227765","GSM2227766","GSM2227767","GSM2227768","GSM2257685","GSM2257686","GSM2257687","GSM2258530","GSM2258531","GSM2258532","GSM2293921","GSM2293922","GSM2293923","GSM2293924","GSM2293925","GSM2293926","GSM2293927","GSM2293928","GSM2293929","GSM2344483","GSM2344484",
          "GSM2344485","GSM2344486","GSM2344487","GSM2344488","GSM2344489","GSM2344490","GSM2346482","GSM2346483","GSM2358917","GSM2358918","GSM2358923","GSM2358924","GSM2358929","GSM2358934","GSM2358935","GSM2358936","GSM2386855","GSM2386857","GSM2386859","GSM2386861","GSM2386863","GSM2386865","GSM2386867","GSM2386869","GSM2386871","GSM2386873","GSM2386875","GSM2386877","GSM2386879","GSM2386881",
          "GSM2386883","GSM2386885","GSM2386887","GSM2386888","GSM2418759","GSM2418760","GSM2418761","GSM2478306","GSM2478307","GSM2478308","GSM2478309","GSM2478310","GSM2478311","GSM2592696","GSM2592697","GSM2592699","GSM2598164","GSM2598166","GSM2598168","GSM2598170","GSM2598172","GSM2598174","GSM2610699","GSM2610702","GSM2628314","GSM2628315","GSM2628316","GSM2628317","GSM2628318","GSM2628319",
          "GSM2628320","GSM2628321","GSM2628322","GSM2628323","GSM2628324","GSM2628325","GSM2628326","GSM2628327","GSM2628328","GSM2628329","GSM2628330","GSM2628331","GSM2628332","GSM2628333","GSM2628334","GSM2628336","GSM2628338","GSM2628341","GSM2628343","GSM2628346","GSM2628349","GSM2628351","GSM2628365","GSM2628367","GSM2628370","GSM2628373","GSM2628375","GSM2628378","GSM2628380","GSM2628383",
          "GSM2628386","GSM2628388","GSM2628391","GSM2628394","GSM2628396","GSM2628398","GSM2628400","GSM2628402","GSM2628406","GSM2628407","GSM2628408","GSM2628409","GSM2628410","GSM2628411","GSM2628412","GSM2628413","GSM2628414","GSM2628415","GSM2628552","GSM2628553","GSM2628556","GSM2628557","GSM2628560","GSM2628561","GSM2638157","GSM2638158","GSM2638159","GSM2638160","GSM2638161","GSM2638162",
          "GSM2638163","GSM2638164","GSM2638165","GSM2638166","GSM2638167","GSM2638168","GSM2638169","GSM2638170","GSM2638171","GSM2638172","GSM2638173","GSM2638174","GSM2638175","GSM2638176","GSM2638177","GSM2638178","GSM2638179","GSM2638180","GSM2638181","GSM2638182","GSM2638183","GSM2638184","GSM2638185","GSM2638186","GSM2638187","GSM2638188","GSM2638189","GSM2638190","GSM2638191","GSM2638192",
          "GSM2638193","GSM2638194","GSM2638195","GSM2638196","GSM2638197","GSM2638198","GSM2638199","GSM2638200","GSM2638201","GSM2638202","GSM2638203","GSM2638204","GSM2638205","GSM2638206","GSM2638207","GSM2638208","GSM2638209","GSM2638210","GSM2638211","GSM2638212","GSM2638213","GSM2638214","GSM2638411","GSM2638413","GSM2638414","GSM2638415","GSM2638417","GSM2638418","GSM2638419","GSM2638420",
          "GSM2638421","GSM2638422","GSM2638423","GSM2638424","GSM2638425","GSM2638426","GSM2638427","GSM2638428","GSM2638429","GSM2638430","GSM2638432","GSM2638433","GSM2638434","GSM2638435","GSM2638436","GSM2638437","GSM2638438","GSM2638439","GSM2638440","GSM2638441","GSM2638442","GSM2638443","GSM2638444","GSM2638445","GSM2638446","GSM2638447","GSM2638449","GSM2638450","GSM2638451","GSM2638452",
          "GSM2638453","GSM2638454","GSM2638455","GSM2638456","GSM2638457","GSM2638458","GSM2638459","GSM2638460","GSM2638462","GSM2638463","GSM2638464","GSM2638465","GSM2638466","GSM2638467","GSM2638468","GSM2638469","GSM2638470","GSM2638471","GSM2638472","GSM2638473","GSM2638474","GSM2638475","GSM2638476","GSM2638477","GSM2638478","GSM2638479","GSM2638480","GSM2638481","GSM2638482","GSM2638483",
          "GSM2638484","GSM2638485","GSM2638486","GSM2638487","GSM2638488","GSM2638489","GSM2638490","GSM2638491","GSM2638492","GSM2638493","GSM2638494","GSM2638495","GSM2638496","GSM2638497","GSM2638498","GSM2638499","GSM2638500","GSM2638501","GSM2638502","GSM2638503","GSM2638504","GSM2638505","GSM2638506","GSM2638507","GSM2638508","GSM2638509","GSM2638510","GSM2638511","GSM2638512","GSM2638513",
          "GSM2638514","GSM2638515","GSM2638516","GSM2638517","GSM2638518","GSM2638519","GSM2638520","GSM2638521","GSM2638522","GSM2638523","GSM2638524","GSM2638525","GSM2638526","GSM2638527","GSM2638528","GSM2638529","GSM2638530","GSM2638531","GSM2638532","GSM2638533","GSM2638534","GSM2638535","GSM2638536","GSM2638537","GSM2638538","GSM2638744","GSM2638745","GSM2638746","GSM2638747","GSM2638748",
          "GSM2638749","GSM2638750","GSM2638751","GSM2638752","GSM2638754","GSM2638755","GSM2638756","GSM2638757","GSM2638758","GSM2638759","GSM2638760","GSM2638761","GSM2638762","GSM2638763","GSM2638764","GSM2638765","GSM2638766","GSM2638767","GSM2638768","GSM2638769","GSM2638770","GSM2638771","GSM2638772","GSM2638773","GSM2638774","GSM2638775","GSM2638776","GSM2638777","GSM2638778","GSM2638779",
          "GSM2638780","GSM2638781","GSM2638782","GSM2638783","GSM2638784","GSM2638785","GSM2638787","GSM2638788","GSM2638789","GSM2638790","GSM2638791","GSM2638793","GSM2638794","GSM2638795","GSM2638796","GSM2638798","GSM2638799","GSM2638800","GSM2638801","GSM2638802","GSM2638804","GSM2638805","GSM2638806","GSM2638808","GSM2638809","GSM2638810","GSM2638812","GSM2638813","GSM2638815","GSM2638816",
          "GSM2638817","GSM2638818","GSM2638819","GSM2638820","GSM2638822","GSM2638823","GSM2638826","GSM2638828","GSM2638829","GSM2638830","GSM2638831","GSM2638832","GSM2638833","GSM2638834","GSM2638835","GSM2638836","GSM2638838","GSM2638839","GSM2638840","GSM2638841","GSM2638842","GSM2638843","GSM2638844","GSM2638845","GSM2638847","GSM2638848","GSM2638849","GSM2638850","GSM2638851","GSM2638852",
          "GSM2638853","GSM2638854","GSM2638855","GSM2638856","GSM2638857","GSM2638859","GSM2638860","GSM2638861","GSM2638862","GSM2638863","GSM2638866","GSM2638867","GSM2638868","GSM2638871","GSM2638872","GSM2638873","GSM2638874","GSM2638875","GSM2638876","GSM2638877","GSM2638879","GSM2638880","GSM2638881","GSM2638883","GSM2638884","GSM2638885","GSM2638886","GSM2638887","GSM2638888","GSM2638889",
          "GSM2638890","GSM2638891","GSM2638892","GSM2638893","GSM2638894","GSM2638895","GSM2638896","GSM2638897","GSM2638898","GSM2638899","GSM2638900","GSM2638901","GSM2638902","GSM2638903","GSM2638904","GSM2638905","GSM2638907","GSM2638908","GSM2638909","GSM2638911","GSM2638912","GSM2638913","GSM2638914","GSM2638915","GSM2638916","GSM2638918","GSM2638919","GSM2638920","GSM2638921","GSM2638923",
          "GSM2638924","GSM2638925","GSM2638926","GSM2638928","GSM2638929","GSM2638930","GSM2638931","GSM2638932","GSM2638933","GSM2638934","GSM2638935","GSM2638936","GSM2638937","GSM2638938","GSM2638939","GSM2638940","GSM2638941","GSM2638942","GSM2638943","GSM2638944","GSM2638945","GSM2638946","GSM2638947","GSM2638948","GSM2638949","GSM2638950","GSM2638951","GSM2638952","GSM2638953","GSM2638954",
          "GSM2638955","GSM2638956","GSM2638957","GSM2638958","GSM2638959","GSM2638960","GSM2638961","GSM2638962","GSM2638963","GSM2638964","GSM2638966","GSM2638967","GSM2638968","GSM2638969","GSM2638970","GSM2638971","GSM2638972","GSM2638973","GSM2638974","GSM2638975","GSM2638976","GSM2638977","GSM2638978","GSM2638979","GSM2638980","GSM2638981","GSM2638982","GSM2638983","GSM2638984","GSM2638985",
          "GSM2638986","GSM2638987","GSM2638988","GSM2638989","GSM2638990","GSM2638991","GSM2638992","GSM2638993","GSM2638994","GSM2638995","GSM2638996","GSM2638997","GSM2638998","GSM2638999","GSM2639000","GSM2639114","GSM2639115","GSM2639116","GSM2639117","GSM2639118","GSM2639119","GSM2639120","GSM2639121","GSM2639122","GSM2639123","GSM2639124","GSM2639125","GSM2639127","GSM2639128","GSM2639129",
          "GSM2639130","GSM2639131","GSM2639132","GSM2639133","GSM2639134","GSM2639135","GSM2639136","GSM2639137","GSM2639138","GSM2639139","GSM2639140","GSM2639141","GSM2639142","GSM2639143","GSM2639144","GSM2639145","GSM2639146","GSM2639147","GSM2639148","GSM2639149","GSM2639150","GSM2639151","GSM2639152","GSM2639153","GSM2639154","GSM2639155","GSM2639157","GSM2639158","GSM2639159","GSM2639160",
          "GSM2639161","GSM2639162","GSM2639163","GSM2639164","GSM2639165","GSM2639166","GSM2639167","GSM2639168","GSM2639169","GSM2639170","GSM2639171","GSM2639172","GSM2639173","GSM2639174","GSM2639175","GSM2639176","GSM2639177","GSM2639178","GSM2639179","GSM2639180","GSM2639181","GSM2639182","GSM2639184","GSM2639185","GSM2639186","GSM2639189","GSM2639190","GSM2639288","GSM2639289","GSM2639291",
          "GSM2639292","GSM2639293","GSM2639296","GSM2639297","GSM2639299","GSM2639300","GSM2639301","GSM2639302","GSM2639303","GSM2639305","GSM2639312","GSM2639314","GSM2639315","GSM2639316","GSM2639317","GSM2639318","GSM2639319","GSM2639320","GSM2639321","GSM2639322","GSM2639323","GSM2639324","GSM2639325","GSM2639326","GSM2639327","GSM2639328","GSM2639329","GSM2639331","GSM2639332","GSM2639333",
          "GSM2639334","GSM2639335","GSM2639336","GSM2639337","GSM2639338","GSM2639339","GSM2639340","GSM2639341","GSM2639342","GSM2639343","GSM2639344","GSM2639345","GSM2639346","GSM2639347","GSM2639348","GSM2639349","GSM2639350","GSM2639351","GSM2639352","GSM2639353","GSM2639354","GSM2639355","GSM2639356","GSM2639357","GSM2639358","GSM2639359","GSM2639360","GSM2639361","GSM2639362","GSM2639363",
          "GSM2639364","GSM2639423","GSM2639484","GSM2639485","GSM2639486","GSM2639487","GSM2639488","GSM2639489","GSM2639490","GSM2639491","GSM2639492","GSM2639493","GSM2639494","GSM2639495","GSM2639496","GSM2639497","GSM2639498","GSM2639499","GSM2639500","GSM2639501","GSM2639502","GSM2639503","GSM2639504","GSM2639505","GSM2639506","GSM2639507","GSM2639508","GSM2639509","GSM2639510","GSM2639511",
          "GSM2639513","GSM2639514","GSM2639515","GSM2639516","GSM2639517","GSM2639518","GSM2639519","GSM2639520","GSM2639521","GSM2639522","GSM2639523","GSM2639524","GSM2639525","GSM2639526","GSM2639527","GSM2639528","GSM2639529","GSM2639530","GSM2639531","GSM2639532","GSM2639533","GSM2639534","GSM2639535","GSM2639536","GSM2639537","GSM2639538","GSM2639539","GSM2639540","GSM2666861","GSM2666862",
          "GSM2666863","GSM2666864","GSM2666865","GSM2666866","GSM2666867","GSM2666868","GSM2666869","GSM2666879","GSM2666880","GSM2666881","GSM2666882","GSM2666883","GSM2666884","GSM2666885","GSM2666886","GSM2666887","GSM2683353","GSM2683356","GSM2683357","GSM2683360","GSM2683361","GSM2683363","GSM2683364","GSM2683366","GSM2683370","GSM2683371","GSM2683372","GSM2683373","GSM2691814","GSM2691815",
          "GSM2691816","GSM2691817","GSM2691821","GSM2691822","GSM2691823","GSM2691824","GSM2714380","GSM2714381","GSM2714382","GSM2714383","GSM2714384","GSM2714385","GSM2714386","GSM2714387","GSM2714388","GSM2714389","GSM2714390","GSM2714391","GSM2715306","GSM2715307","GSM2774816","GSM2774817","GSM2774818","GSM2774819","GSM2774820","GSM2774821","GSM2786833","GSM2786834","GSM2786835","GSM2786839",
          "GSM2786840","GSM2786841","GSM2786842","GSM2828374","GSM2828375","GSM2840074","GSM2840075","GSM2840076","GSM2136902","GSM2136903","GSM2136904","GSM2136905","GSM2136906","GSM2136907","GSM2136908","GSM2136909","GSM2136910","GSM2136911","GSM2219524","GSM2219525","GSM2219526","GSM2219527","GSM2219528","GSM2219529","GSM2219530","GSM2219531","GSM2304753","GSM2304754","GSM2304755","GSM2304759",
          "GSM2304760","GSM2304761","GSM2304765","GSM2304766","GSM2304767","GSM2304771","GSM2304772","GSM2304773","GSM2304777","GSM2304778","GSM2304779","GSM2304783","GSM2304784","GSM2304785","GSM2559910","GSM2559911","GSM2559912","GSM2559913","GSM2559914","GSM2559915","GSM2559916","GSM2559917","GSM2559918","GSM2561560","GSM2561561","GSM2716093","GSM2716094","GSM2898191","GSM2907019","GSM2907020",
          "GSM2907021","GSM2265061","GSM2265062","GSM2265063","GSM2265064","GSM2265065","GSM2265066","GSM2265067","GSM2265068","GSM2265069","GSM2265070","GSM2299679","GSM2299680","GSM2332435","GSM2332436","GSM2332437","GSM2452023","GSM2452024","GSM2452025","GSM2589768","GSM2589769","GSM2589770","GSM2589771","GSM2705199","GSM2705200","GSM2772579","GSM2772581","GSM2772583","GSM2825733","GSM2825734",
          "GSM2825735","GSM2825736","GSM2825737","GSM2825738","GSM2825739","GSM2825740","GSM2825741","GSM2825742","GSM2825743","GSM2825744","GSM2825745","GSM2825746","GSM2825747","GSM2825748","GSM2825758","GSM2825759","GSM2825760","GSM2825761","GSM2825762","GSM2825763","GSM2825764","GSM2825765","GSM2825766","GSM2833285","GSM2833288","GSM2833289","GSM2833291","GSM2858498","GSM2858499","GSM2858500",
          "GSM2858501","GSM2858502","GSM2858503","GSM2858504","GSM2858505","GSM2889476","GSM2889477","GSM2889478","GSM2889479","GSM2898192","GSM1530536","GSM1530537","GSM1656736","GSM1656737","GSM1656738","GSM1656739","GSM1656740","GSM1656741","GSM1656742","GSM1656743","GSM1706491","GSM1706492","GSM1824695","GSM1824696","GSM1873376","GSM1873377","GSM1873470","GSM1873471","GSM1873472","GSM1873473",
          "GSM1873476","GSM1873477","GSM1873480","GSM1873481","GSM1944931","GSM1944932","GSM1944933","GSM1944934","GSM1944935","GSM1944937","GSM1944938","GSM1944940","GSM1970651","GSM1970652","GSM1970653","GSM1970654","GSM1970655","GSM1970656","GSM1970657","GSM1970658","GSM1970659","GSM1970660","GSM1970667","GSM1970668","GSM1970669","GSM1970670","GSM1970671","GSM1970672","GSM1970673","GSM1970674",
          "GSM1970675","GSM1970676","GSM1970677","GSM1970678","GSM1970687","GSM1970688","GSM1970689","GSM1970690","GSM1970691","GSM1970692","GSM1970693","GSM1970694","GSM1970695","GSM1970696","GSM1970697","GSM1970704","GSM1970705","GSM1970706","GSM1970707","GSM1970708","GSM1970709","GSM1970710","GSM1970711","GSM1970720","GSM1970721","GSM1970722","GSM1970723","GSM1970724","GSM1970725","GSM1970738",
          "GSM1970739","GSM1970740","GSM1970741","GSM1970742","GSM1970743","GSM1970756","GSM1970757","GSM1970758","GSM1970759","GSM1970760","GSM1970761","GSM1970762","GSM1970763","GSM1970764","GSM1970765","GSM1970780","GSM1970781","GSM1970782","GSM1974899","GSM1974900","GSM1974901","GSM1974902","GSM1974903","GSM1974904","GSM1981232","GSM1981233","GSM1981234","GSM1981235","GSM1981236","GSM1981237",
          "GSM1981238","GSM1981239","GSM2065422","GSM2065423","GSM2065424","GSM2065425","GSM2065426","GSM2065427","GSM2065428","GSM2065429","GSM2065430","GSM2065431","GSM2065432","GSM2065433","GSM2065434","GSM2065435","GSM2065436","GSM2065437","GSM2065438","GSM2065439","GSM2065440","GSM2065441","GSM2065442","GSM2065443","GSM2065444","GSM2065445","GSM2065446","GSM2065447","GSM2065448","GSM2065449",
          "GSM2065450","GSM2065451","GSM2065452","GSM2065453","GSM2065454","GSM2065455","GSM2065456","GSM2065457","GSM2065458","GSM2065459","GSM2065460","GSM2065461","GSM2065462","GSM2065463","GSM2065464","GSM2065465","GSM2065466","GSM2065467","GSM2065468","GSM2065469","GSM2065470","GSM2065471","GSM2065472","GSM2065473","GSM2065474","GSM2065475","GSM2065476","GSM2065477","GSM2065478","GSM2065479",
          "GSM2065480","GSM2065481","GSM2065482","GSM2065483","GSM2065484","GSM2065485","GSM2065486","GSM2065487","GSM2065488","GSM2065489","GSM2065491","GSM2071735","GSM2104099","GSM2104100","GSM2104101","GSM2104105","GSM2104106","GSM2104108","GSM2104109","GSM2104111","GSM2104113","GSM2195199","GSM2195200","GSM2195201","GSM2195202","GSM2200014","GSM2200015","GSM2200016","GSM2209888","GSM2209889",
          "GSM2209892","GSM2209893","GSM2209894","GSM2212600","GSM2212601","GSM2212602","GSM2241941","GSM2241942","GSM2241943","GSM2325606","GSM2325607","GSM2325608","GSM2325609","GSM2325614","GSM2325615","GSM2325616","GSM2325617","GSM2325622","GSM2325623","GSM2325624","GSM2325625","GSM2357407","GSM2357408","GSM2357409","GSM2357410","GSM2357411","GSM2357412","GSM2357413","GSM2357414","GSM2397546",
          "GSM2397547","GSM2397548","GSM2397587","GSM2397588","GSM2397589","GSM2397591","GSM2397592","GSM2397593","GSM2418607","GSM2418608","GSM2418609","GSM2418610","GSM2418611","GSM2418612","GSM2422491","GSM2422492","GSM2422493","GSM2422494","GSM2422495","GSM2422496","GSM2422497","GSM2422498","GSM2422499","GSM2422500","GSM2422501","GSM2422515","GSM2422516","GSM2422517","GSM2467676","GSM2467677",
          "GSM2467678","GSM2467679","GSM2467680","GSM2467681","GSM2467682","GSM2467683","GSM2467684","GSM2467685","GSM2467686","GSM2467687","GSM2467688","GSM2467689","GSM2467690","GSM2467691","GSM2467692","GSM2467693","GSM2467694","GSM2467695","GSM2467696","GSM2467697","GSM2467698","GSM2467699","GSM2467700","GSM2467701","GSM2467702","GSM2467703","GSM2467704","GSM2467705","GSM2467706","GSM2467707",
          "GSM2467708","GSM2467709","GSM2467710","GSM2467711","GSM2467712","GSM2467713","GSM2467714","GSM2467715","GSM2467716","GSM2467717","GSM2467718","GSM2467719","GSM2467720","GSM2467721","GSM2467722","GSM2467723","GSM2467724","GSM2467725","GSM2467726","GSM2467727","GSM2467728","GSM2467729","GSM2467730","GSM2467731","GSM2467732","GSM2467733","GSM2467734","GSM2467735","GSM2538287","GSM2538288",
          "GSM2538289","GSM2538293","GSM2538294","GSM2538295","GSM2538299","GSM2538300","GSM2538301","GSM2538305","GSM2538306","GSM2538307","GSM2548641","GSM2548642","GSM2548643","GSM2548644","GSM2548645","GSM2548646","GSM2548647","GSM2548648","GSM2548649","GSM2588285","GSM2588286","GSM2588287","GSM2588288","GSM2588289","GSM2588290","GSM2588291","GSM2588292","GSM2588298","GSM2588299","GSM2588300",
          "GSM2588301","GSM2588313","GSM2588314","GSM2588326","GSM2588327","GSM2588331","GSM2588332","GSM2588333","GSM2588334","GSM2588335","GSM2588336","GSM2588337","GSM2588338","GSM2588341","GSM2588342","GSM2588343","GSM2588344","GSM2588348","GSM2588349","GSM2588350","GSM2588351","GSM2588352","GSM2588353","GSM2588354","GSM2588355","GSM2588358","GSM2588359","GSM2588360","GSM2588361","GSM2588367",
          "GSM2588373","GSM2588380","GSM2593490","GSM2593491","GSM2593493","GSM2593494","GSM2593495","GSM2593497","GSM2593499","GSM2593501","GSM2593502","GSM2593503","GSM2593505","GSM2593506","GSM2593508","GSM2593509","GSM2593512","GSM2593514","GSM2593515","GSM2593519","GSM2593521","GSM2671343","GSM2671344","GSM2671345","GSM2671346","GSM2671347","GSM2671348","GSM2671349","GSM2671350","GSM2671351",
          "GSM2671352","GSM2671353","GSM2671354","GSM2674783","GSM2674786","GSM2674787","GSM2674788","GSM2674792","GSM2674793","GSM2686137","GSM2686138","GSM2686139","GSM2686140","GSM2757547","GSM2757548","GSM2757549","GSM2757556","GSM2757557","GSM2883340","GSM2883341","GSM2883342","GSM2883343","GSM2883344","GSM2883345","GSM2895593","GSM2895594","GSM2895597","GSM2895598","GSM2948617","GSM2948618",
          "GSM2948619","GSM2948620","GSM2948621","GSM2948622","GSM2948623","GSM2948624","GSM2948625","GSM2948626","GSM2948627","GSM2948628","GSM2120832","GSM2120833","GSM2120834","GSM2120837","GSM2120838","GSM2752182","GSM2789659","GSM2789660","GSM2789661","GSM2940306","GSM2940307","GSM2940308","GSM2940309","GSM2940313","GSM2940314","GSM2940315","GSM2522693","GSM2522694","GSM2522695","GSM2522696",
          "GSM2522697","GSM2522698","GSM2522705","GSM2522706","GSM2522707","GSM2522708","GSM2870529","GSM2870530","GSM2944022","GSM2944023","GSM2944024","GSM2944025","GSM2983147","GSM2983148","GSM2983152","GSM2983153","GSM2983154","GSM2983158","GSM2983159","GSM2983160","GSM3026841","GSM3026842","GSM2589031","GSM2736984","GSM2736985","GSM2736986","GSM2736987","GSM2736988","GSM2736989","GSM2736990",
          "GSM2736991","GSM2825679","GSM2825680","GSM2825681","GSM2825685","GSM2825686","GSM2825687","GSM2985489","GSM2985490","GSM2985491","GSM2985492","GSM2985493","GSM2985494","GSM2985495","GSM2985496","GSM3123512","GSM3123513","GSM3123514","GSM3123515","GSM2041485","GSM2041486","GSM2041489","GSM2041490","GSM2187977","GSM2187978","GSM2187981","GSM2187982","GSM2187985","GSM2187986","GSM2263170",
          "GSM2263171","GSM2263172","GSM2263173","GSM2263174","GSM2263182","GSM2263183","GSM2263184","GSM2263185","GSM2263186","GSM2528073","GSM2528074","GSM2528075","GSM2528076","GSM2528077","GSM2528078","GSM2702337","GSM2702338","GSM2702339","GSM2714150","GSM2714151","GSM2714152","GSM2714153","GSM2714154","GSM2714155","GSM2715161","GSM2715162","GSM2715163","GSM2715164","GSM2715167","GSM2715168",
          "GSM2715169","GSM2715170","GSM2793632","GSM2793633","GSM2793634","GSM2859806","GSM2859807","GSM2859808","GSM2866867","GSM2866868","GSM2875768","GSM2875769","GSM2875770","GSM2875774","GSM2875775","GSM2875776","GSM2882367","GSM2882368","GSM2907121","GSM2907122","GSM2907123","GSM3036892","GSM3036893","GSM3036894","GSM3036895","GSM3036896","GSM3036897","GSM3058879","GSM3058880","GSM2561498",
          "GSM2723978","GSM2723979","GSM2723980","GSM2723984","GSM2723985","GSM3111065","GSM3111066","GSM3111067","GSM3111070","GSM3111071","GSM3111075","GSM3111076","GSM3111077","GSM2461451","GSM2461452","GSM2461453","GSM2461454","GSM2461455","GSM2461456","GSM2461457","GSM2461458","GSM2461459","GSM2461460","GSM2461461","GSM2461462","GSM2461463","GSM2461464","GSM2461465","GSM2461466","GSM2196876",
          "GSM2196877","GSM2196878","GSM2196879","GSM2196884","GSM2196885","GSM2196886","GSM2218605","GSM2218606","GSM2341988","GSM2341989","GSM2341990","GSM2341991","GSM2442966","GSM2442967","GSM2442968","GSM2442969","GSM2521667","GSM2521668","GSM2521669","GSM2521671","GSM2525861","GSM2525862","GSM2525863","GSM2525864","GSM2525865","GSM2525866","GSM2525867","GSM2525868","GSM2525869","GSM2525870",
          "GSM2525871","GSM2525872","GSM2525873","GSM2525874","GSM2525875","GSM2525876","GSM2525877","GSM2525878","GSM2525879","GSM2525880","GSM2525881","GSM2525882","GSM2525883","GSM2525884","GSM2561556","GSM2561557","GSM2561564","GSM2561565","GSM2561568","GSM2561569","GSM2561572","GSM2561574","GSM2653113","GSM2653114","GSM2671211","GSM2671212","GSM2671213","GSM2671214","GSM2684108","GSM2684109",
          "GSM2684110","GSM2684111","GSM2684112","GSM2684113","GSM2684114","GSM2684115","GSM2684116","GSM2684117","GSM2684118","GSM2684119","GSM2684120","GSM2684121","GSM2684122","GSM2684123","GSM2684124","GSM2684125","GSM2684126","GSM2684127","GSM2684128","GSM2684129","GSM2684130","GSM2684131","GSM2684132","GSM2684133","GSM2684134","GSM2684135","GSM2684136","GSM2684137","GSM2684138","GSM2684139",
          "GSM2684140","GSM2684141","GSM2684142","GSM2684143","GSM2684144","GSM2684145","GSM2684146","GSM2684147","GSM2684148","GSM2684149","GSM2684150","GSM2684151","GSM2684152","GSM2684153","GSM2684154","GSM2684155","GSM2684156","GSM2684157","GSM2684158","GSM2684159","GSM2684160","GSM2684161","GSM2684162","GSM2684163","GSM2684164","GSM2684165","GSM2684166","GSM2684167","GSM2684168","GSM2684169",
          "GSM2684170","GSM2684171","GSM2684172","GSM2684173","GSM2684174","GSM2684175","GSM2684176","GSM2684177","GSM2684178","GSM2684179","GSM2684180","GSM2684181","GSM2684182","GSM2684183","GSM2684184","GSM2684185","GSM2684186","GSM2684187","GSM2684188","GSM2684189","GSM2684190","GSM2684191","GSM2684192","GSM2701042","GSM2701043","GSM2788823","GSM2788824","GSM2788825","GSM2788829","GSM2788830",
          "GSM2788831","GSM2935273","GSM3075921","GSM3075922","GSM3075923","GSM3075924","GSM3075929","GSM3075930","GSM3075931","GSM3075932","GSM2883203","GSM2883204","GSM2884127","GSM2884128","GSM1412840","GSM1412841","GSM1412844","GSM1412845","GSM1974996","GSM1974997","GSM1974998","GSM1976924","GSM1976926","GSM2059156","GSM2059158","GSM2059159","GSM2059162","GSM2059163","GSM2059164","GSM2059165",
          "GSM2059168","GSM2059169","GSM2059172","GSM2059173","GSM2059177","GSM2059178","GSM2059179","GSM2237791","GSM2237792","GSM2237794","GSM2237795","GSM2705207","GSM2705208","GSM2705209","GSM2705210","GSM2705211","GSM2705212","GSM2705213","GSM2705214","GSM2705215","GSM2705216","GSM2705217","GSM2705218","GSM2705219","GSM2705220","GSM2808464","GSM2808465","GSM2521680","GSM2521681","GSM2521682",
          "GSM2521683","GSM2521684","GSM2521685","GSM2521686","GSM2521687","GSM2521688","GSM2521689","GSM2521690","GSM2521691","GSM2521692","GSM2521693","GSM2521694","GSM2521695","GSM2648476","GSM2648477","GSM2648478","GSM3169053","GSM3169054","GSM3169055","")

  # take difference between all samples
  all_samples = unique(c(cas9, crispr, induction, knockdown, knockout, ko, overexpression, over_expression))
  
  # Retrieve information from compressed data
  samples = h5read(destination_file, "meta/Sample_geo_accession")
  tissue = h5read(destination_file, "meta/Sample_source_name_ch1")
  genes = h5read(destination_file, "meta/genes")
  # name = h5read(destination_file, 'meta/Sample_source_name_ch1') -- this is the same as tissue
  organism = h5read(destination_file, 'meta/Sample_organism_ch1')
  characteristics = h5read(destination_file, 'meta/Sample_characteristics_ch1')
  #treatment_protocol = h5read(destination_file, 'meta/Sample_treatment_protocol_ch1') -- included in geo data, but not in h5
  description = h5read(destination_file, 'meta/Sample_description')
  title = h5read(destination_file, 'meta/Sample_title')
  
  # create data.frame of all samples with associated information
  h5_metadata_df <- data.frame(organism, samples, tissue, characteristics, description, title)
  h5_metadata_df_subset <- subset(h5_metadata_df, h5_metadata_df$samples %in% all_samples)
  
  print(nrow(h5_metadata_df_subset))
  
  # close h5
  H5close()
  
  # remove rows with string cancer
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(cancer)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(cancer)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(cancer)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(cancer)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  # remove rows with string carcin
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(carcin)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(carcin)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(carcin)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(carcin)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  # remove rows with string tumor
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(tumor)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(tumor)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(tumor)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(tumor)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  # remove phoma and luekemia
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(phoma)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(phoma)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(phoma)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(phoma)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(luekemia)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(luekemia)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(luekemia)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(luekemia)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  # remove samples with influenza
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(influenza)', h5_metadata_df_subset$tissue, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(influenza)', h5_metadata_df_subset$characteristics, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(influenza)', h5_metadata_df_subset$description, ignore.case = TRUE),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(influenza)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  
  # remove samples with W-T in 'tissue' (single experiment w/40 samples, no gene manipulation)
  h5_metadata_df_subset <- h5_metadata_df_subset[!grepl('(W-T)', h5_metadata_df_subset$title, ignore.case = TRUE),]
  

  print(nrow(h5_metadata_df_subset))
  
  # de-duplicate 'tissue' column (only one replicate from each expirement will remain).
  h5_metadata_df_subset <- arrange(h5_metadata_df_subset, tissue)
  h5_metadata_df_subset <- h5_metadata_df_subset[!duplicated(h5_metadata_df_subset[,"tissue"]),]
  h5_metadata_df_subset <- h5_metadata_df_subset[!duplicated(h5_metadata_df_subset[,"characteristics"]),]
  
  print(nrow(h5_metadata_df_subset))
  
  # create vector gse with series corresponding to samples
  gse <- character(length = length(h5_metadata_df_subset$samples))
  j <- 1
  for(i in h5_metadata_df_subset$samples){
    gse[j] <- Meta(getGEO(i))$series_id
    j <- j+1
  }
  
  # add gse column to dataframe 
  mouse_gse <- h5_metadata_df_subset 
  mouse_gse[,'GSE'] <- gse
  
  # deduplicate on GSE
  mouse_gse <- mouse_gse[!duplicated(mouse_gse[,'GSE']),]
  
  # count rows
  print(nrow(mouse_gse))
  
  # get overall experimenet design from series softs
  overall_design <- character(length = length(mouse_gse$GSE))
  j <- 1
  for(i in mouse_gse$GSE){
    x <- Meta(getGEO(i, GSEMatrix = FALSE))$overall_design
    overall_design[j] <- x
    j <- j+1
  }
  
  gse_design <- mouse_gse['GSE']
  gse_design[, 'overall_design'] <- overall_design
  
  # write design table
  #write.csv(gse_design, 'poss_tx_datasets_seriesDesign_mouse.csv')
  #print(paste0('series design created at', getwd(), '/', 'poss_tx_datasets_seriesDesign_mouse.csv'))
  
  # Print file
  #write.csv(h5_metadata_df_subset, 'mouse_possible_txfactor_datasets.csv')
  #print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))
}

# to look at
# GSM2639162